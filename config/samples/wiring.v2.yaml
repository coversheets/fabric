###########################################
#* switch-1
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: Switch
metadata:
  labels:
    wiring.githedgehog.com/rack: rack-1
  name: switch-1
spec:
  profile: vs-bcom #* List of ports, ASIC, limits, etc are coming from our switch DB in the profile
  location:
    location: DC1-Fl
    aisle: "10"
    row: "2"
    slot: "24"
    rack: "rack-1"
  locationSig:
    sig: sig
    uuidSig: uuidSig
  #bgpConfig: {} #* In future for spine leaf
  lldpConfig: #* Mgmt IP is taken from the management connection
    helloTimer: 5 #* Optional, default is 5
    #systemDescription: This is switch-1 #* Generated from switch name
    #systemName: switch-1 #* Switch name
status:
  neighbors: #* Skipping for now, will be done on demand
    - port: Ethernet0
      neighbor:
        server: server-1/nic0/port0
    - port: Ethernet56
      neighbor:
        switch: switch-2/Ethernet56
---
###########################################
#* switch-1 <> switch-2 (MCLAG)
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: Connection
metadata:
  labels: {}
  name: mclag-1--switch-1--switch-2
spec:
  mclagDomain:
    # domainID: 1 #! always use 1 LOL
    # sourceIP: 10.0.200.X #* Auto, IP from the mngmt port
    # peerIP: 10.0.200.Y #* Auto, IP from the mngmt port neighbor
    # peerLink: PortChannel1 #* Auto
    links:
      - - switchPort:
            name: switch-1/Ethernet56
            #* some custom port config possible here
        - switchPort:
            name: switch-2/Ethernet56
      - - switchPort:
            name: switch-1/Ethernet57
        - switchPort:
            name: switch-2/Ethernet57
---
###########################################
#* server-1
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: Server
metadata:
  labels:
    wiring.githedgehog.com/rack: rack-1
  name: server-1
spec:
  location: {}
  locationSig: {}
  profile: 2nics2ports #* Lists of NICs and Ports, etc are coming from the profile, user can create their own server profiles
---
###########################################
#* server-1 <> (switch-1,switch-2) (MCLAG)
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: Connection
metadata:
  labels: {}
  name: server-1--mclag-1--switch-1--switch-2
spec:
  mclag: #* or lag or unbundled
    # domainID: 1 #! always use 1 LOL
    links:
      - - serverPort:
            name: server-1/nic0/port0
        - switchPort:
            name: switch-1/Ethernet0
      - - serverPort:
            name: server-1/nic1/port0
        - switchPort:
            name: switch-2/Ethernet0
---
###########################################
#* server-2 <> switch-2 (NO MCLAG)
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: Connection
metadata:
  labels: {}
  name: server-2--switch-2
spec:
  unbundled:
    link:
      - serverPort:
          name: server-2/nic0/port0
      - switchPort:
          name: switch-2/Ethernet1
---
###########################################
#* control-1
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: Server
metadata:
  labels:
    wiring.githedgehog.com/rack: rack-1
  name: control-1
spec:
  control: true #* control node
  location: {}
  locationSig: {}
  profile: 2nics2ports
---
###########################################
#* control-1 <> switch-1
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: Connection
metadata:
  labels: {}
  name: control-1--mgmt--switch-1
spec:
  management: #* same as unbundled, but to indicate it's a managment connection
    #? maybe have a VLAN here?
    #? probably some hints for ONIE config
    # onie:
    #   portNum: 0
    #   portName: eth0
    #   bootstrapIP: 192.168.1.1/24
    #   vlan: 300
    link:
      - server:
          name: control-1/nic0/port1
      - switch:
          name: switch-1/Management0
---
###########################################
#* Some naming conventions for connections
#* - leaf first, spine second
#* - if collapsedcore, alphanumeric? order
#* - server first, switch second
###########################################

###########################################
#* vs-bcom switch profile
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: SwitchProfile
metadata:
  labels: {}
  name: vs-bcom
spec:
  limits:
    vpc: 500
    policies: 1000
  ports:
    - name: Management0
      management: true
    - name: Ethernet0
      id: 0
      #* additionally, info about speed/media, good for uplink/downlink, breakout
    # ...
    - name: Ethernet47
      id: 47
---
###########################################
#* 2nics2ports server profile
###########################################
apiVersion: wiring.githedgehog.com/v1alpha2
kind: ServerProfile
metadata:
  labels: {}
  name: 2nics2ports
spec:
  nics:
    - name: nic0
      ports:
        - name: port0
        - name: port1
    - name: nic1
      ports:
        - name: port0
        - name: port1
